<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization · DifferentialEvolutionMCMC</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DifferentialEvolutionMCMC</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../binomial/">Binomial Model</a></li><li><a class="tocitem" href="../gaussian/">Gaussian Model</a></li><li class="is-active"><a class="tocitem" href>Optimization</a><ul class="internal"><li><a class="tocitem" href="#Load-Packages"><span>Load Packages</span></a></li><li><a class="tocitem" href="#Initialize-the-DE-Algorithm"><span>Initialize the DE Algorithm</span></a></li><li><a class="tocitem" href="#Objective-Function"><span>Objective Function</span></a></li><li><a class="tocitem" href="#Define-Bounds-and-Parameter-Names"><span>Define Bounds and Parameter Names</span></a></li><li><a class="tocitem" href="#Define-Model-Object"><span>Define Model Object</span></a></li><li><a class="tocitem" href="#Define-Sampler"><span>Define Sampler</span></a></li><li><a class="tocitem" href="#Optimize-the-Function"><span>Optimize the Function</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../api/">api</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">examples</a></li><li class="is-active"><a href>Optimization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimization</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/itsdfish/DifferentialEvolutionMCMC.jl/blob/master/docs/src/optimization.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Optimization-Example"><a class="docs-heading-anchor" href="#Optimization-Example">Optimization Example</a><a id="Optimization-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-Example" title="Permalink"></a></h1><p>The purpose of this example is to demonstrate how to optimize a function as opposed to perform Bayesian parameter estimation.</p><h2 id="Load-Packages"><a class="docs-heading-anchor" href="#Load-Packages">Load Packages</a><a id="Load-Packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-Packages" title="Permalink"></a></h2><p>Our first step is to load the required packages.</p><pre><code class="language-julia hljs">using DifferentialEvolutionMCMC
using DifferentialEvolutionMCMC: minimize!
using Distributions
using Random
Random.seed!(6845)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><h2 id="Initialize-the-DE-Algorithm"><a class="docs-heading-anchor" href="#Initialize-the-DE-Algorithm">Initialize the DE Algorithm</a><a id="Initialize-the-DE-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Initialize-the-DE-Algorithm" title="Permalink"></a></h2><p>Each particle in DifferentialEvolution must be seeded with an initial value. To do so, we define a function that returns the initial value. Even though we are not performing Bayesian parameter estimation, we want to use prior information to intelligently seed the DE algorithm. In our case, we will return a vector contained in a vector. </p><pre><code class="language-julia hljs">function sample_prior()
    return [rand(Uniform(-5, 5), 2)]
 end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">sample_prior (generic function with 1 method)</code></pre><h2 id="Objective-Function"><a class="docs-heading-anchor" href="#Objective-Function">Objective Function</a><a id="Objective-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Objective-Function" title="Permalink"></a></h2><p>In this example, we will find the minimum of the <a href="https://en.wikipedia.org/wiki/Rastrigin_function">rastrigin</a>, which challenging due to its &quot;egg carton-like&quot; surface containing several local minima. </p><p><img src="https://upload.wikimedia.org/wikipedia/commons/8/8b/Rastrigin_function.png" alt/></p><p>The minimum of the rastrigin function is the zero vector for input <code>x</code>. The code block below defines the rastrigin function for an input vector of an arbitrary length. Since we will not be passing data to the function, we will set the first argument to <code>_</code> and assign it a value of <code>nothing</code> below.</p><pre><code class="language-julia hljs">function rastrigin(_, x)
    A = 10.0
    n = length(x)
    y = A * n
    for  i in 1:n
        y +=  + x[i]^2 - A * cos(2 * π * x[i])
    end
    return y
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">rastrigin (generic function with 1 method)</code></pre><h2 id="Define-Bounds-and-Parameter-Names"><a class="docs-heading-anchor" href="#Define-Bounds-and-Parameter-Names">Define Bounds and Parameter Names</a><a id="Define-Bounds-and-Parameter-Names-1"></a><a class="docs-heading-anchor-permalink" href="#Define-Bounds-and-Parameter-Names" title="Permalink"></a></h2><p>We must define the lower and upper bounds of each parameter. The bounds are a <code>Tuple</code> of tuples, where the <span>$i^{\mathrm{th}}$</span> inner tuple contains the lower and upper bounds of the <span>$i^{\mathrm{th}}$</span> parameter. In the <code>rastrigin</code> function, <code>x</code> is a vector with an unspecified length. The bounds below applies to each element in <code>x</code>.</p><pre><code class="language-example hljs">bounds = ((-5.0,5.0),)</code></pre><p>We can also pass a <code>Tuple</code> of names for the argument <code>x</code>.</p><pre><code class="language-julia hljs">names = (:x,)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:x,)</code></pre><h2 id="Define-Model-Object"><a class="docs-heading-anchor" href="#Define-Model-Object">Define Model Object</a><a id="Define-Model-Object-1"></a><a class="docs-heading-anchor-permalink" href="#Define-Model-Object" title="Permalink"></a></h2><p>Now that we have defined the necessary components of our model, we will organize them into a <code>DEModel</code> object as shown below. Notice that <code>data = nothing</code> because we do not need data for this optimization problem.</p><pre><code class="language-julia hljs">model = DEModel(;
    sample_prior,
    loglike = rastrigin,
    data = nothing,
    names)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DEModel{DifferentialEvolutionMCMC.var&quot;#8#10&quot;{typeof(Main.rastrigin), Nothing, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}, Tuple{}}, DifferentialEvolutionMCMC.var&quot;#7#9&quot;{Nothing}, Tuple{Symbol}, typeof(Main.sample_prior)}(DifferentialEvolutionMCMC.var&quot;#7#9&quot;{Nothing}(nothing), DifferentialEvolutionMCMC.var&quot;#8#10&quot;{typeof(Main.rastrigin), Nothing, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}, Tuple{}}(Main.rastrigin, nothing, Base.Pairs{Symbol, Union{}, Tuple{}, NamedTuple{(), Tuple{}}}(), ()), Main.sample_prior, (:x,))</code></pre><h2 id="Define-Sampler"><a class="docs-heading-anchor" href="#Define-Sampler">Define Sampler</a><a id="Define-Sampler-1"></a><a class="docs-heading-anchor-permalink" href="#Define-Sampler" title="Permalink"></a></h2><p>Next, we will create a sampler with the constructor <code>DE</code>. Here, we will pass the <code>sample_prior</code> function and the variable <code>bounds</code>, which constains the lower and upper bounds of each parameter. In addition, we will specify <span>$1,000$</span> burnin samples, <code>Np=10</code> particles for <code>n_groups=1</code> groups. In the last two keyword arguments, we use <code>minimize!</code> for the <code>update_particle!</code> function because we want to minimize <code>rastrigin</code>, and <code>evaluate_fitness! = evaluate_fun!</code> because we do not want to incorporate the prior log likelihood into our evaluation of <code>rastrigin</code>.</p><pre><code class="language-julia hljs">de = DE(;
    sample_prior,
    bounds,
    Np = 10,
    n_groups = 1,
    update_particle! = minimize!,
    evaluate_fitness! = evaluate_fun!)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DE{Tuple{Tuple{Float64, Float64}}, typeof(random_gamma), typeof(DifferentialEvolutionMCMC.minimize!), typeof(evaluate_fun!), typeof(sample), DifferentialEvolutionMCMC.var&quot;#3#5&quot;, Vector{Bool}, Array{Vector{Float64}, 3}}(1, 10, 1000, true, 0.0, 0.1, 0.001, 0.05, 1.0, 0.0, ((-5.0, 5.0),), 0, 1, DifferentialEvolutionMCMC.random_gamma, DifferentialEvolutionMCMC.minimize!, DifferentialEvolutionMCMC.evaluate_fun!, StatsBase.sample, DifferentialEvolutionMCMC.var&quot;#3#5&quot;(), Bool[0], Array{Vector{Float64}, 3}(undef, 0, 0, 0))</code></pre><h2 id="Optimize-the-Function"><a class="docs-heading-anchor" href="#Optimize-the-Function">Optimize the Function</a><a id="Optimize-the-Function-1"></a><a class="docs-heading-anchor-permalink" href="#Optimize-the-Function" title="Permalink"></a></h2><p>The code block below runs the optimizer for <span>$2000$</span> iterations with the progress bar. </p><pre><code class="language-julia hljs">n_iter = 2000
particles = optimize(model, de, n_iter, progress=true);
results = get_optimal(de, model, particles)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">((x = [4.6364069198896645e-7, -1.0812811123627673e-5],), 2.3238030166794488e-8)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gaussian/">« Gaussian Model</a><a class="docs-footer-nextpage" href="../api/">api »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 8 July 2023 21:12">Saturday 8 July 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
